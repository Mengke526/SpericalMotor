clc,clear
uM0 = 1.465; % 剩余磁化强度 T
Rp = 45.5*10^(-3); % PM中心距 mm->m
Re = 38.31*10^(-3); % EM中心距 mm->m
Ao = 20*10^(-3); % PM直径 mm->m
ao = 20*10^(-3); % EM外径 mm->m
ai = 8*10^(-3); % EM内径 mm->m
L = 5*10^(-3); % PM高度 mm->m
l = 6*10^(-3); % EM高度 mm->m
a2 = 0.09*10^(-6); % EM线圈截面积
fLambda = [0.00792353136209439,0.00788013867354309,0.00775226403175040,0.00754601607036815,0.00726976839935982,0.00693297591056508,0.00654552539376292,0.00611739738735583,0.00565838471838492,0.00517783922591364,0.00468452649179253,0.00418643828443043,0.00369073442073169,0.00320392847419728,0.00273169789135496,0.00228007495997591,0.00185382800822041,0.00145704899120044,0.00109423188710723,0.000768771128782850,0.000482936849311967,0.000238256741262313,3.49238999160915e-05,-0.000128621159965197,-0.000254616726077558,-0.000346696887466891,-0.000409605603319607,-0.000448755436431803,-0.000469571083984539,-0.000476938214789917,-0.000474766956044250,-0.000466025425862123,-0.000452924238425683,-0.000437073625543780,-0.000419632182288899,-0.000401423314293560,-0.000383023937731820,-0.000364830830542856,-0.000347109936616320,-0.000330032756334238,-0.000313703104229409,-0.000298176699749977,-0.000283475457611953,-0.000269597934816600,-0.000256526839420440,-0.000244234496942140,-0.000232686764475616,-0.000221845812466377,-0.000211672103924836,-0.000202125761633343,-0.000193167506016316,-0.000184759288613396,-0.000176864679957677,-0.000169449111847288,-0.000162479991742271,-0.000155926748993765,-0.000149760802045778,-0.000143955554331962,-0.000138486219876311,-0.000133329824306726,-0.000128465052394920,-0.000123872161093456,-0.000119532863218247,-0.000115430230980833,-0.000111548588922846,-0.000107873456949727,-0.000104391392201502,-0.000101089961244418,-9.79576513045679e-05,-9.49837904391792e-05,-9.21584845296408e-05,-8.94725561173398e-05,-8.69174876433779e-05,-8.44853694655289e-05,-8.21688522113264e-05,-7.99611029031793e-05,-7.78557644192755e-05,-7.58469185103229e-05,-7.39290521602273e-05,-7.20970265097175e-05,-7.03460479250410e-05,-6.86716420737699e-05,-6.70696300524691e-05,-6.55361059013598e-05,-6.40674166465503e-05,-6.26601437420916e-05,-6.13110858352971e-05,-6.00172430152354e-05,-5.87756818014128e-05,-5.75836283308651e-05,-5.64389332936549e-05,-5.53391531825280e-05,-5.42821256420846e-05,-5.32659556217579e-05,-5.22888700782492e-05,-5.13487334587625e-05,-5.04438280396618e-05,-4.95723407769950e-05,-4.87329218371720e-05,-4.79241455479454e-05,-4.71447294100252e-05,-4.63932704352896e-05,-4.56686329580472e-05,-4.49698200463924e-05,-4.42955497470104e-05,-4.36447930511251e-05,-4.30165754569473e-05,-4.24099736364694e-05,-4.18241124196251e-05,-4.12581618860877e-05,-4.07113346122773e-05,-4.01827767314195e-05,-3.96716837240129e-05,-3.91775976681153e-05,-3.86999312398277e-05,-3.82379986025564e-05,-3.77912522744455e-05,-3.73592615115769e-05,-3.69415098406626e-05,-3.65373445182519e-05,-3.61462903595701e-05,-3.57678947244414e-05,-3.54017262898722e-05,-3.50473740212684e-05,-3.47044459291008e-05,-3.43725683009558e-05,-3.40513846149722e-05,-3.37405547198979e-05,-3.34396959324764e-05,-3.31485340032737e-05,-3.28668065085335e-05,-3.25942360246759e-05,-3.23305385555439e-05,-3.20754499905393e-05,-3.18287968531588e-05,-3.15902912859905e-05,-3.13596923521397e-05,-3.11367854871705e-05,-3.09213656583952e-05,-3.07132369922637e-05,-3.05122123575479e-05,-3.03181129333072e-05,-3.01307678807029e-05,-2.99500140196554e-05,-2.97756955084416e-05,-2.96076635144317e-05,-2.94457759551928e-05,-2.92898972047240e-05,-2.91398979371986e-05,-2.89956547266093e-05,-2.88570499373737e-05,-2.87239826912625e-05,-2.85963355709753e-05,-2.84740065425167e-05,-2.83568961128012e-05,-2.82449011074763e-05,-2.81379468889622e-05,-2.80359527845982e-05,-2.79388404125833e-05,-2.78465356135976e-05,-2.77589683269110e-05,-2.76760724426598e-05,-2.75977857692148e-05,-2.75240498174490e-05,-2.74548098062915e-05,-2.73900145721890e-05,-2.73296164063075e-05,-2.72735710392952e-05,-2.72218375107406e-05,-2.71743781723499e-05,-2.71311586032076e-05,-2.70921475978409e-05,-2.70573170476877e-05,-2.70266418676377e-05,-2.70001001286624e-05,-2.69776728960525e-05,-2.69593440290061e-05,-2.69451004834933e-05,-2.69349322213268e-05,-2.69288328503470e-05,-2.69267953857989e-05];
x = linspace(0,180,181);
figure(1)
plot(x,fLambda)
grid on
xlabel('\sigma (deg)');
ylabel('f(\sigma)');
dx = linspace(0.5,179.5,180);
dy = zeros(1,length(dx));
for i = 1:length(dx)
    dy(i) = (fLambda(i+1)-fLambda(i))/(pi/180);
end
figure(2)
plot(dx,dy,'ro')
grid on
xlabel('\sigma (deg)');
ylabel('f ‘(\sigma)');
hold on
for i = 1:length(dx)
    dyf(i) = dfLambdaFit(dx(i));
end
plot(dx,dyf,'b-')